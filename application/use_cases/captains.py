import csvimport warningsfrom pathlib import Pathimport requestsfrom requests.auth import HTTPBasicAuthfrom helpers.common import transliterate_bulgarian_to_english, validate_phone_numberfrom models.captain import Captainwarnings.filterwarnings('ignore', message='Unverified HTTPS request')captains = []root_dir = Path.joinpath(Path(__file__).parent.parent.parent, 'data')csv_file_path = Path.joinpath(root_dir, 'vessels.csv')data = []def add_driver_traccar(driver):    url = f'https://fvmspnc.iara.government.bg/api/drivers/'    auth = HTTPBasicAuth('n.vlahovski@scortel.com', 'birka24')    response = requests.post(url, headers={'Content-Type': 'application/json'}, auth=auth, json=driver.to_dict())    if response.status_code == 200:        return response.json() if len(response.json()) > 0 else {}    else:        return {}with open(csv_file_path, mode='r', encoding='utf-8') as file:    csv_reader = csv.reader(file)    next(csv_reader)    for row in csv_reader:        data.append(row)for row in data:    captain = Captain()    call_sign = mmsi = ""    cfr, idp, ip, external_marking, ship_name, length, width, call_sign_mmsi, ship_owner, company_address, email, captain_name, contact_phone = row    try:        call_sign, mmsi = str(call_sign_mmsi).split("/")    except Exception:        call_sign = call_sign_mmsi    if validate_phone_number(contact_phone):        captain.set("isCaptain", True)        captain.name = captain_name        captain.set("nameEn", transliterate_bulgarian_to_english(captain_name))        captain.uniqueId = validate_phone_number(contact_phone)        captains.append(captain)for captain in captains:    add_driver_traccar(captain)